Debootstrap Ubuntu Bionic Beaver | Disco Dingo | Eoan Ermine XFCE / MATE / GNOME / BSPWM (BIOS Legacy)
-------------------------------------------------------------------------------------------------------

Atualizado: 20/06/2019
Contato Telegram: @rocker_raccoon

- Baixe o ISO do Xubuntu mais recente copiando e colando os comandos abaixo no terminal
cd ~/Downloads ; wget -c http://cdimage.ubuntu.com/xubuntu/daily-live/current/eoan-desktop-amd64.iso

- Espete o pen drive e grave o live USB com o comando abaixo substituindo o X pela letra da unidade (exemplo: /dev/sdc)
sudo dd bs=4M if=eoan-desktop-amd64.iso of=/dev/sdX status=progress && sync

- Dê boot na maquina com o live USB e quando aparecer uma imagem na parte inferior da tela, aperte F2 e escolha a o idioma "Português do Brasil"

- Quando carregar o sistema, abra o terminal e digite os comandos abaixo
sudo apt install -y arch-install-scripts debootstrap git geany ; cd $HOME ; wget https://github.com/binolinux/misc/raw/master/geany.zip ; unzip geany.zip ; 
sudo su

- Formate a partição usando o Gparted ou use o terminal

- Monte a partição destino em /mnt com o comando
mount /dev/sdXn /mnt

- Opção 1: Faça o debooststrap da base do Ubuntu Bionic Beaver com o comando abaixo
debootstrap bionic /mnt http://archive.ubuntu.com/ubuntu ; rm -f /mnt/etc/apt/sources.list ; wget https://github.com/binolinux/misc/raw/master/docs/ubuntu/bionic-sources.list -O /mnt/etc/apt/sources.list ; genfstab -U -p /mnt > /mnt/etc/fstab

- Opção 2: Faça o debooststrap da base do Ubuntu Disco Dingo com o comando abaixo
debootstrap disco /mnt http://archive.ubuntu.com/ubuntu ; rm -f /mnt/etc/apt/sources.list ; wget https://github.com/binolinux/misc/raw/master/docs/ubuntu/dingo-sources.list -O /mnt/etc/apt/sources.list ; genfstab -U -p /mnt > /mnt/etc/fstab

- Opção 3: Faça o debooststrap da base do Ubuntu Eoan Ermine com o comando abaixo
debootstrap eoan /mnt http://archive.ubuntu.com/ubuntu ; rm -f /mnt/etc/apt/sources.list ; wget https://github.com/binolinux/misc/raw/master/docs/ubuntu/eoan-sources.list -O /mnt/etc/apt/sources.list ; genfstab -U -p /mnt > /mnt/etc/fstab

- Entre em Chroot
arch-chroot /mnt/ /bin/bash

- Defina as variaveis com nome de usuario e hostname
#nnu="NOMEDOUSUARIO" ; hst="NOMEDAMAQUINA"
nnu="bino" ; hst="keoan"

- Configure o apt
echo 'APT::Install-Recommends "0";' | tee /etc/apt/apt.conf ; echo 'APT::Install-Suggests "0";' | tee -a /etc/apt/apt.conf ; apt update -y ; apt full-upgrade -y

- Opção 1: Instalar o kernel padrão e pacotes essenciais ao funcionamento do sistema (grub-pc deve sersubstituido por grub-efi no caso de uma instação UEFI)
apt install -y linux-{image,headers}-generic dhcpcd5 grub-pc locales gnupg wget git ca-certificates ntfs-3g dosfstools p7zip-full xinit xserver-xorg-core xserver-xorg-input-all xdg-user-dirs x11-xserver-utils x11-session-utils rsync nano alsa-utils network-manager ttf-dejavu ttf-ubuntu-font-family zsh netplan.io ufw software-properties-common arch-install-scripts # os-prober

- Opção 2: Instalar o kernel estavel mais atual e pacotes essenciais ao funcionamento do sistema (grub-pc deve sersubstituido por grub-efi no caso de uma instação UEFI)
#apt install -y wget ; cd /tmp ; wget https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.1.10/linux-headers-5.1.10-050110-generic_5.1.10-050110.201906151034_amd64.deb ; wget https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.1.10/linux-headers-5.1.10-050110_5.1.10-050110.201906151034_all.deb ; wget https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.1.10/linux-image-unsigned-5.1.10-050110-generic_5.1.10-050110.201906151034_amd64.deb ; wget https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.1.10/linux-modules-5.1.10-050110-generic_5.1.10-050110.201906151034_amd64.deb ; dpkg -i linux-headers*.deb linux-image*.deb linux-modules*.deb ; apt install -y dhcpcd5 grub-pc locales gnupg git ca-certificates ntfs-3g dosfstools p7zip-full xinit xserver-xorg-core xserver-xorg-input-all xdg-user-dirs x11-xserver-utils x11-session-utils rsync nano alsa-utils network-manager ttf-dejavu ttf-ubuntu-font-family zsh netplan.io ufw software-properties-common arch-install-scripts # os-prober

- Cria o diretorio temporário e baixa configurações dos desktop
mkdir -p /temp ; cd /temp ; wget https://github.com/binolinux/misc/raw/master/configs-de-wm/default.7z ; wget https://github.com/binolinux/look/raw/master/fontes-ttf-pack.7z ; 7z x -y default.7z ; 7z x -y fontes-ttf-pack.7z
#wget https://github.com/binolinux/misc/raw/master/configs-de-wm/gnome.7z ; wget https://github.com/binolinux/misc/raw/master/configs-de-wm/kde-plasma.7z ; wget https://github.com/binolinux/misc/raw/master/configs-de-wm/mate.7z ; wget https://github.com/binolinux/misc/raw/master/configs-de-wm/oxpenbox.7z ; wget https://github.com/binolinux/misc/raw/master/configs-de-wm/xfce4.7z ; wget https://github.com/binolinux/look/raw/master/arc-themes.7z ; wget https://github.com/binolinux/look/raw/master/tela-icon-theme.7z ;  ; 7z x -y fontes-ttf-pack.7z ; 7z x -y arc-themes.7z ; 7z x -y tela-icon-theme.7z ; mkdir usr/share/icons ; mv Tela* usr/share/icons

- Opção 1: XFCE4 Desktop minimo com Nemo
apt install -y gtk2-engines-xfce libxfce4ui-utils xfce4-appfinder xfce4-panel xfce4-pulseaudio-plugin xfce4-session xfce4-settings xfconf xfdesktop4 xfwm4 xfce4-terminal xfce4-whiskermenu-plugin xfce4-clipman-plugin xfce4-notifyd pulseaudio pavucontrol nemo file-roller nemo-fileroller cinnamon-l10n htop gtk2-engines-murrine gtk2-engines-pixbuf libexo-1-0 policykit-1-gnome xfce4-screenshooter ristretto tumbler network-manager-gnome ; ln -sf /usr/bin/xfce4-terminal /usr/bin/gnome-terminal ; echo "exec startxfce4" >> /etc/skel/.xinitrc ; echo 'export XDG_SESSION_TYPE="X11"' >> /etc/skel/.zprofile ; echo "startx" >> /etc/skel/.zprofile ; add-apt-repository -y ppa:xuzhen666/dockbarx ; sed -i 's/eoan/disco/' /etc/apt/sources.list.d/xuzhen666-ubuntu-dockbarx-eoan.list ; apt update -y ; apt install -y dockbarx dockbarx-themes-extra xfce4-dockbarx-plugin

- Opção 2: Mate Desktop minimo com Nemo
apt install -y marco mate-control-center mate-desktop mate-menus mate-notification-daemon mate-panel mate-applet-brisk-menu mate-polkit mate-session-manager mate-utils mate-settings-daemon mate-terminal mate-screensaver eom mate-applets mate-media mate-calc pulseaudio htop gtk2-engines gtk2-engines-murrine gtk2-engines-pixbuf nemo file-roller nemo-fileroller cinnamon-l10n ; ln -sf /usr/bin/mate-terminal /usr/bin/gnome-terminal ; echo "exec mate-session" >> /etc/skel/.xinitrc ; echo 'export XDG_SESSION_TYPE="X11"' >> /etc/skel/.zprofile ; echo "startx" >> /etc/skel/.zprofile ; cd /temp ; 7z x -y default.7z ; 7z x -y mate.7z ; rm -f *.7z

- Opção 3: Plasma Desktop minimo com Nemo
apt install -y plasma-desktop breeze-gtk-theme breeze kscreen systemsettings kde-config-gtk-style kio-extras kwin-x11 kwin-addons pulseaudio plasma-pa plasma-nm plasma-widgets-addons sddm tilix nemo file-roller nemo-fileroller cinnamon-l10n libdbus-glib-1-2 flameshot galculator viewnior ; systemctl enable -f sddm ; mkdir -p /etc/sddm.conf.d/ ; echo -e '[Autologin]\nUser='$nnu'\nSession=plasma.desktop' | tee /etc/sddm.conf.d/autologin.conf ;  ln -sf /usr/bin/tilix /usr/bin/gnome-terminal ; echo "exec startkde" >> /etc/skel/.xinitrc ; echo 'export XDG_SESSION_TYPE="X11"' >> /etc/skel/.zprofile ; echo "startx" >> /etc/skel/.zprofile ; sed -i 's/Exec/#Exec/g' /usr/share/dbus-1/services/org.kde.kwalletd.service ; sed -i 's/Exec/#Exec/g' /usr/share/dbus-1/services/org.kde.kwalletd5.service

- Opção 4: Gnome-Shell minimo com Nemo
apt install -y gnome-shell gnome-control-center gnome-session gnome-backgrounds chrome-gnome-shell gnome-screenshot gnome-screensaver gnome-tweak-tool tilix file-roller nemo nemo-fileroller cinnamon-l10n eog network-manager-gnome ; ln -sf /usr/bin/tilix /usr/bin/gnome-terminal ; echo "export GDK_BACKEND=x11" >> /etc/skel/.xinitrc ; echo 'exec gnome-session' >> /etc/skel/.zprofile ; echo "startx" >> /etc/skel/.zprofile

- Opção 5: BSPWM com Nemo
apt install -y sakura bspwm sxhkd lxpolkit lxappearance tint2 volumeicon-alsa arandr compton feh gtk2-engines gtk2-engines-murrine galculator gmrun flameshot xdg-user-dirs dunst pulseaudio pavucontrol

- Opção 6: Openbox + XFC4-Panel + Dockbarx
add-apt-repository -y ppa:xuzhen666/dockbarx ; sed -i 's/eoan/disco/' /etc/apt/sources.list.d/xuzhen666-ubuntu-dockbarx-eoan.list ; apt update -y ; apt install -y obsession openbox compton lxpolkit lxappearance lxappearance-obconf volumeicon-alsa pavucontrol alsa-utils pulseaudio arandr nemo nemo-fileroller file-roller cinnamon-l10n xfce4-terminal xfce4-panel xfce4-whiskermenu-plugin dockbarx dockbarx-themes-extra xfce4-dockbarx-plugin flameshot ; apt install -y dockbarx dockbarx-themes-extra xfce4-dockbarx-plugin
#editar o autorun com /usr/bin/lxpolkit

- Opção 7: Cinnammon 4.x (instalavel apenas no Bionic Beaver)
add-apt-repository -y ppa:trebelnik-stefina/cinnamon ; apt update -y ; apt install -y cinnamon gnome-backgrounds nemo nemo-fileroller file-roller tilix xviewer

- Configure o idioma e fuso horario
dpkg-reconfigure locales ; dpkg-reconfigure tzdata

- icones Papirus e wallpapers
wget -qO- https://raw.githubusercontent.com/PapirusDevelopmentTeam/papirus-icon-theme/master/install.sh | sh ; clear # git clone https://github.com/binolinux/backgrounds /opt/Wallpapers/

# Configurando o sistema
cd /temp ; rm -f *.7z *.001 *.002 *.003 ; clear ; echo -e '\nAguarde...\n\n' ; chmod 755 -R /temp/ ; chown -R root:root /temp/ ; cp -rT /temp/ / ; cd /etc/skel ; mkdir -p ".bin" ".icons" ".themes" "Desktop" "Documentos" "Downloads" "Imagens" "Música" "Público" "Modelos" "Vídeos" ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/gtk-3.0/bookmarks ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/transmission/settings.json ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/audacious/config ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/vlc/vlc-qt-interface.conf ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/audacious/playlist-state ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/ksmserverrc ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/plasma-org.kde.plasma.desktop-appletsrc ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/plasmarc ; sed -i 's/zzzzz/'$nnu'/' /etc/skel/.config/QtProject.conf ; sed -i 's/zzzzz/'$nnu'/' /usr/local/bin/freemem ; ln -sf /opt/Wallpapers /etc/skel/Imagens/ ; fc-cache ; gtk-update-icon-cache /usr/share/icons/{breeze_cursors,Breeze_Snow,oxy-black,oxy-grey,oxy-steel,oxy-white,oxy-whitewater,oxy-zion}

Drivers de video:
------------------

- Driver Nouveau (free) 
Bionic Beaver: apt install -y xserver-xorg-video-nouveau-hwe-16.04
Disco Dingo | Eoan Ermine: apt install -y xserver-xorg-video-nouveau-hwe-18.04

- Driver Nvidia (propietário)
##add-apt-repository -y ppa:graphics-drivers/ppa ; apt update -y ; apt full-upgrade -y ; apt install -y nvidia-driver-418 nvidia-settings
mv /etc/apt/apt.conf /etc/apt/.apt.conf ; apt install -y nvidia-driver-430 ; mkdir -p /etc/X11/xorg.conf.d/ ; wget https://github.com/binolinux/misc/raw/master/docs/ubuntu/20-nvidia.conf -P /etc/X11/xorg.conf.d/ ; cp /etc/default/grub /etc/default/.grub ; sed -i 's/"quiet splash"/"nouveau.modeset=0 quiet splash"/' /etc/default/grub ; mv /etc/apt/.apt.conf /etc/apt/apt.conf

- Driver VESA (generico)
Bionic Beaver: apt install -y xserver-xorg-video-vesa-hwe-16.04
Disco Dingo | Eoan Ermine: apt install -y xserver-xorg-video-vesa-hwe-18.04

- Driver VMWare (VirtualBox)
Bionic Beaver: apt install -y xserver-xorg-video-vmware-hwe-16.04
Disco Dingo | Eoan Ermine: apt install -y xserver-xorg-video-vmware-hwe-18.04

- Driver ATI
Bionic Beaver: apt install -y xserver-xorg-video-ati-hwe-16.04
Disco Dingo | Eoan Ermine: apt install -y xserver-xorg-video-ati-hwe-18.04

- Driver AMDGPU
Bionic Beaver: apt install -y xserver-xorg-video-amdgpu-hwe-16.04
Disco Dingo | Eoan Ermine: apt install -y xserver-xorg-video-amdgpu-hwe-18.04

- Driver Intel
Bionic Beaver: apt install -y xserver-xorg-video-intel-hwe-16.04
Disco Dingo | Eoan Ermine: apt install -y xserver-xorg-video-intel-hwe-18.04

- Desabilita o OS-Prober
echo "GRUB_DISABLE_OS_PROBER=true" | tee -a /etc/default/grub ; grub-mkconfig -o /boot/grub/grub.cfg

- Navegador Firefox Beta
apt install -y libdbus-glib-1-2 ; cd /tmp/ ; wget "https://download.mozilla.org/?product=firefox-beta-latest-ssl&os=linux64&lang=pt-BR" -O firefox.tar.bz2 ; tar -jxvf firefox.tar.bz2 -C /opt/ ; echo -e '[Desktop Entry]\nVersion=1.0\nName=Firefox Beta\nGenericName=Web Browser\nGenericName[pt_BR]=Navegador Web\nComment=Browse the World Wide Web\nComment[pt_BR]=Navegue na Internet\nKeywords=Internet;WWW;Browser;Web;Explorer\nKeywords[pt_BR]=Internet;WWW;Browser;Web;Explorador;Navegador\nExec=/usr/local/bin/firefox %u\nIcon=firefox\nTerminal=false\nX-MultipleArgs=false\nType=Application\nMimeType=text/html;text/xml;application/xhtml+xml;x-scheme-handler/http;x-scheme-handler/https;application/x-xpinstall;\nStartupNotify=true\nStartupWMClass=Firefox\nCategories=Network;WebBrowser;\nActions=new-window;new-private-window;\n\n[Desktop Action new-window]\nName=New Window\nName[pt_BR]=Nova janela\nExec=/usr/local/bin/firefox --new-window %u\n\n[Desktop Action new-private-window]\nName=New Private Window\nName[pt_BR]=Nova janela privativa\nExec=/usr/local/bin/firefox --private-window %u' | tee /usr/share/applications/firefox-beta.desktop ; ln -sf /opt/firefox/firefox /usr/local/bin/

- Navegador Firefox
apt install -y firefox firefox-locale-pt

- Navegador Google Chrome
cd /tmp ; wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb -O google-chrome.deb ; apt install -y ./google-chrome.deb

- Navegador Chromium com suporte a Netflix
apt install -y chromium-browser chromium-browser-l10n ; cd /tmp ; wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb -O google-chrome.deb ; 7z x -y google-chrome.deb ; 7z x -y data.tar ; cp ./opt/google/chrome/libwidevinecdm.so /usr/lib/chromium

- Seletor de linguagem
##apt install -y language-selector-gnome

- Instala GIMP mais recente (necessario apenas para o Bionic Beaver)
add-apt-repository -y ppa:otto-kesselgulasch/gimp ; apt update -y ; apt install -y gimp

- SMPlayer mais recente (opcional)
add-apt-repository -y ppa:rvm/smplayer ; apt update -y ; apt install -y smplayer smplayer-themes smplayer-skins mpv

- SMPlayer mais recente (repositorio)
apt update -y ; apt install -y smplayer smplayer-l10n smplayer-themes mpv ; cd /tmp ; wget https://launchpad.net/~rvm/+archive/ubuntu/smplayer/+files/smplayer-skins_15.2.0-1~bionic1_all.deb -O smplayer-skins.deb ; apt install -y ./smplayer-skins.deb

- Instala demais aplicativos
apt install -y gnome-disk-utility gparted ffmpeg x264 easytag mediainfo-gui transmission-gtk geany gufw

- Telegram Desktop
cd /tmp ; wget "https://telegram.org/dl/desktop/linux" -O telegram.tar.xz ; tar Jxf telegram.tar.xz -C /opt/ ; ln -sf /opt/Telegram/Telegram /usr/local/bin/telegram-desktop ; mkdir -p /etc/skel/.config/autostart ; echo -e '[Desktop Entry]\nVersion=1.0\nName=Telegram Desktop\nComment=Official desktop application for the Telegram messaging service\nTryExec=/usr/local/bin/telegram-desktop\nExec=/usr/local/bin/telegram-desktop -startintray\nIcon=telegram\nTerminal=false\nStartupWMClass=TelegramDesktop\nType=Application\nCategories=Network;InstantMessaging;Qt;\nMimeType=x-scheme-handler/tg;\nKeywords=tg;chat;im;messaging;messenger;sms;tdesktop;\nX-GNOME-UsesNotifications=true\nX-Desktop-File-Install-Version=0.24\nX-GNOME-Autostart-enabled=true\nX-GNOME-Autostart-Delay=10' | tee /etc/skel/.config/autostart/telegram-desktop.desktop ; chmod +x /etc/skel/.config/autostart/telegram-desktop.desktop

# oh-my-zsh, plugins & neofetch
git clone https://github.com/robbyrussell/oh-my-zsh /usr/share/oh-my-zsh ; git clone https://github.com/zsh-users/zsh-autosuggestions.git /usr/share/oh-my-zsh/plugins/zsh-autosuggestions ; git clone https://github.com/zsh-users/zsh-syntax-highlighting.git /usr/share/oh-my-zsh/plugins/zsh-syntax-highlighting ; rm -rf /usr/share/oh-my-zsh/.git /usr/share/oh-my-zsh/plugins/zsh-autosuggestions/.git /usr/share/oh-my-zsh/plugins/zsh-syntax-highlighting/.git ; cp /usr/share/oh-my-zsh/templates/zshrc.zsh-template /etc/skel/.zshrc ; sed -i 's/(git)/(compleat common-aliases extract zsh-autosuggestions zsh-syntax-highlighting)/' /etc/skel/.zshrc
wget https://github.com/dylanaraps/neofetch/raw/master/neofetch -O /usr/local/bin/neofetch ; chmod +x /usr/local/bin/neofetch

- Hostname
echo $hst > /etc/hostname

- Crie o novo usuario
adduser $nnu ; adduser $nnu sudo ; chsh -s /bin/zsh $nnu

- Senha do root
passwd ; chsh -s /bin/zsh ; cp -a /usr/share/oh-my-zsh /root ; cp /usr/share/oh-my-zsh/templates/zshrc.zsh-template /root/.zshrc

- Diminuir o swappiness
mkdir -p /etc/sysctl.d/ ; echo 'vm.swappiness=10' | tee -a /etc/sysctl.d/99-sysctl.conf

- Configura o Network-Manager (netplan)
mkdir -p /etc/netplan/ ; echo -e 'network:\n  version: 2\n  renderer: NetworkManager' | sudo tee /etc/netplan/01-netcfg.yaml ; netplan --debug apply

- Bloqueios no hosts
htn=`cat /etc/hostname` ; mv /etc/hosts /etc/.hosts ; wget https://github.com/binolinux/misc/raw/master/docs/hosts -O /etc/hosts ; sed -i 's/zzzzz/'$htn'/' /etc/hosts

- Ative os serviços
systemctl enable {dhcpcd,network-manager,ufw}

- Modifique o fstab
echo -e '\n#tmpfs\ntmpfs /tmp tmpfs defaults,nosuid,nodev,size=2G 0 0\ntmpfs /home/'$nnu'/.cache tmpfs defaults,nosuid,nodev,size=5G 0 0' | tee -a /etc/fstab

- Modifica permissao da pasta
chown -R $nnu:root /home/$nnu

- Limpa p sistema
rm -rf /temp

- Encerre o chroot
exit

- Desmonte a unidade e reinicie o sistema
umount -R /mnt && reboot

#Links: 
#https://wiki.archlinux.org/index.php/Swap#Swappiness
#https://websiteforstudents.com/configure-static-ip-addresses-on-ubuntu-18-04-beta/

